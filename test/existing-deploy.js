import {Foundry} from '../src/index.js';

const bytecode = '0x608060405234801561001057600080fd5b5060405161020d38038061020d833981810160405281019061003291906100db565b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050610108565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006100a88261007d565b9050919050565b6100b88161009d565b81146100c357600080fd5b50565b6000815190506100d5816100af565b92915050565b6000602082840312156100f1576100f0610078565b5b60006100ff848285016100c6565b91505092915050565b60f7806101166000396000f3fe6080604052348015600f57600080fd5b506004361060285760003560e01c80632f5f3b3c14602d575b600080fd5b60336047565b604051603e919060a8565b60405180910390f35b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000609482606b565b9050919050565b60a281608b565b82525050565b600060208201905060bb6000830184609b565b9291505056fea2646970667358221220de47f60730f1832f2977e9cdbdc3ce4f87eec278e9bac04d273d7193dfc7b1b564736f6c634300081a003300000000000000000000000048f5931c5dbc2cd9218ba085ce87740157326f59';

const foundry = await Foundry.launch();
try {
	const abi = [
		`constructor(address a)`,
		`function pointer() view returns (address)`,
	];
	const A = await foundry.deploy({bytecode, contract: 'A', abi});
	const addr = foundry.wallets.admin.address
	const B = await foundry.deploy({bytecode: bytecode.slice(0, -64), contract: 'B', abi, args: [addr]});

	console.log(await A.pointer());
	console.log(await B.pointer());
	console.log(await B.pointer() === addr);
} finally {
	await foundry.shutdown();
}
